<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>connection_expiration.rb</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>connection_expiration.rb
</h1>
<div class='paths'>
lib/sequel/extensions/connection_expiration.rb
</div>
<div class='last-update'>
Last Update:
<span class='datetime'>2023-06-12 13:05:49 -0700</span>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>The connection_expiration extension modifies a database’s connection pool to validate that connections checked out from the pool are not expired, before yielding them for use.  If it detects an expired connection, it removes it from the pool and tries the next available connection, creating a new connection if no available connection is unexpired.  Example of use:</p>

<pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">extension</span>(<span class="ruby-value">:connection_expiration</span>)
</pre>

<p>The default connection timeout is 14400 seconds (4 hours). To override it:</p>

<pre class="ruby"><span class="ruby-constant">DB</span>.<span class="ruby-identifier">pool</span>.<span class="ruby-identifier">connection_expiration_timeout</span> = <span class="ruby-value">3600</span> <span class="ruby-comment"># 1 hour</span>
</pre>

<p>Note that this extension does not work with the single threaded and sharded single threaded connection pools. As the only reason to use the single threaded pools is for speed, and this extension makes the connection pool slower, there’s not much point in modifying this extension to work with the single threaded pools.  The non-single threaded pools work fine even in single threaded code, so if you are currently using a single threaded pool and want to use this extension, switch to using another pool.</p>

<p>Related module: <a href="../../../../classes/Sequel/ConnectionExpiration.html"><code>Sequel::ConnectionExpiration</code></a></p>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>

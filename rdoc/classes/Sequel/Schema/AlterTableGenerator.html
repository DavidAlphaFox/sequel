<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Sequel::Schema::AlterTableGenerator</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>class</span>
Sequel::Schema::AlterTableGenerator
</h1>
<ol class='paths'>
<li>
<a href="../../../files/lib/sequel/database/schema_generator_rb.html">lib/sequel/database/schema_generator.rb</a>
</li>
</ol>
<div class='parent'>
Superclass:
<strong>Object</strong>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p><a href="AlterTableGenerator.html"><code>Schema::AlterTableGenerator</code></a> is an internal class that the user is not expected to instantiate directly.  Instances are created by <a href="../Database.html#method-i-alter_table"><code>Database#alter_table</code></a>. It is used to specify table alteration parameters.  It takes a <a href="../Database.html"><code>Database</code></a> object and a block of operations to perform on the table, and gives the <a href="../Database.html"><code>Database</code></a> an array of table altering operations, which the database uses to alter a table’s description.</p>

<p>For more information on Sequel’s support for schema modification, see the <a href="../../../files/doc/schema_modification_rdoc.html">“Schema Modification” guide</a>.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-new">new</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-add_column">add_column</a></li>
<li><a href="#method-i-add_constraint">add_constraint</a></li>
<li><a href="#method-i-add_foreign_key">add_foreign_key</a></li>
<li><a href="#method-i-add_full_text_index">add_full_text_index</a></li>
<li><a href="#method-i-add_index">add_index</a></li>
<li><a href="#method-i-add_primary_key">add_primary_key</a></li>
<li><a href="#method-i-add_spatial_index">add_spatial_index</a></li>
<li><a href="#method-i-add_unique_constraint">add_unique_constraint</a></li>
<li><a href="#method-i-drop_column">drop_column</a></li>
<li><a href="#method-i-drop_constraint">drop_constraint</a></li>
<li><a href="#method-i-drop_foreign_key">drop_foreign_key</a></li>
<li><a href="#method-i-drop_index">drop_index</a></li>
<li><a href="#attribute-i-operations">operations</a></li>
<li><a href="#method-i-rename_column">rename_column</a></li>
<li><a href="#method-i-set_column_allow_null">set_column_allow_null</a></li>
<li><a href="#method-i-set_column_default">set_column_default</a></li>
<li><a href="#method-i-set_column_not_null">set_column_not_null</a></li>
<li><a href="#method-i-set_column_type">set_column_type</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='attribute-list'>
<h2 class='section-bar'>Attributes</h2>
<div class='name-list'>
<table>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-operations'>operations</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>An array of operations to perform</p>
</td>
</tr>
</table>
</div>
</div>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span><span class='arguments'>(db, &block)</span>

</div>
<div class='description'>

<p>Set the <a href="../Database.html"><code>Database</code></a> object to which to apply the changes, and evaluate the block in the context of this object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">436</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">db</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">437</span>   <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">db</span>
<span class="line-num">438</span>   <span class="ruby-ivar">@operations</span> = []
<span class="line-num">439</span>   <span class="ruby-identifier">instance_exec</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
<span class="line-num">440</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-add_column'>
<a name='method-i-add_column'></a>
<div class='synopsis'>
<span class='name'>add_column</span><span class='arguments'>(name, type, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a column with the given name, type, and opts. See <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a> for the available options.</p>

<pre class="ruby"><span class="ruby-identifier">add_column</span>(<span class="ruby-value">:name</span>, <span class="ruby-constant">String</span>) <span class="ruby-comment"># ADD COLUMN name varchar(255)</span>
</pre>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:if_not_exists </td><td>
<p>Set to true to not add the column if it already exists (PostgreSQL 9.6+)</p>
</td></tr></tbody></table>

<p>MySQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:after </td><td>
<p>The name of an existing column that the new column should be positioned after</p>
</td></tr><tr><td class='label'>:first </td><td>
<p>Create this new column before all other existing columns</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_column-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_column-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">455</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">456</span>   <span class="ruby-identifier">op</span> = {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:add_column</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">type</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">457</span>   <span class="ruby-identifier">index_opts</span> = <span class="ruby-identifier">op</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:index</span>)
<span class="line-num">458</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">op</span>
<span class="line-num">459</span>   <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">index_opts</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">index_opts</span> <span class="ruby-operator">:</span> <span class="ruby-constant">OPTS</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">index_opts</span>
<span class="line-num">460</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">461</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_constraint'>
<a name='method-i-add_constraint'></a>
<div class='synopsis'>
<span class='name'>add_constraint</span><span class='arguments'>(name, *args, &block)</span>

</div>
<div class='description'>

<p>Add a constraint with the given name and args. See <a href="CreateTableGenerator.html#method-i-constraint"><code>CreateTableGenerator#constraint</code></a>.</p>

<pre class="ruby"><span class="ruby-identifier">add_constraint</span>(<span class="ruby-value">:valid_name</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">like</span>(<span class="ruby-value">:name</span>, <span class="ruby-string">&#39;A%&#39;</span>))
<span class="ruby-comment"># ADD CONSTRAINT valid_name CHECK (name LIKE &#39;A%&#39; ESCAPE &#39;\&#39;)</span>
<span class="ruby-identifier">add_constraint</span>({<span class="ruby-value">name:</span> <span class="ruby-value">:valid_name</span>, <span class="ruby-value">deferrable:</span> <span class="ruby-keyword">true</span>}, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">like</span>(<span class="ruby-value">:name</span>, <span class="ruby-string">&#39;A%&#39;</span>))
<span class="ruby-comment"># ADD CONSTRAINT valid_name CHECK (name LIKE &#39;A%&#39; ESCAPE &#39;\&#39;) DEFERRABLE INITIALLY DEFERRED</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_constraint-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_constraint-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">470</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_constraint</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">471</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> {<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">name</span>}
<span class="line-num">472</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:op</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:add_constraint</span>, <span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:check</span>, <span class="ruby-value">:check</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">block</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">args</span>)
<span class="line-num">473</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">474</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_foreign_key'>
<a name='method-i-add_foreign_key'></a>
<div class='synopsis'>
<span class='name'>add_foreign_key</span><span class='arguments'>(name, table, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a foreign key with the given name and referencing the given table. See <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a> for the available options.</p>

<p>You can also pass an array of column names for creating composite foreign keys. In this case, it will assume the columns exist and will only add the constraint.  You can provide a :name option to name the constraint.</p>

<p>NOTE: If you need to add a foreign key constraint to a single existing column use the composite key syntax even if it is only one column.</p>

<pre class="ruby"><span class="ruby-identifier">add_foreign_key</span>(<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:table</span>) <span class="ruby-comment"># ADD COLUMN artist_id integer REFERENCES table</span>
<span class="ruby-identifier">add_foreign_key</span>([<span class="ruby-value">:name</span>], <span class="ruby-value">:table</span>) <span class="ruby-comment"># ADD FOREIGN KEY (name) REFERENCES table</span>
</pre>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:not_valid </td><td>
<p>Set to true to add the constraint with the NOT VALID syntax. This makes it so that future inserts must respect referential integrity, but allows the constraint to be added even if existing column values reference rows that do not exist.  After all the existing data has been cleaned up, validate_constraint can be used to mark the constraint as valid.  Note that this option only makes sense when using an array of columns.</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_foreign_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_foreign_key-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">519</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">520</span>   <span class="ruby-keyword">return</span> <span class="ruby-identifier">add_composite_foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">521</span>   <span class="ruby-identifier">add_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">Integer</span>, {<span class="ruby-value">:table</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">table</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">522</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_full_text_index'>
<a name='method-i-add_full_text_index'></a>
<div class='synopsis'>
<span class='name'>add_full_text_index</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a full text index on the given columns. See <a href="CreateTableGenerator.html#method-i-full_text_index"><code>CreateTableGenerator#full_text_index</code></a> for available options.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_full_text_index-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_full_text_index-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">526</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_full_text_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">527</span>   <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">columns</span>, {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:full_text</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">528</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_index'>
<a name='method-i-add_index'></a>
<div class='synopsis'>
<span class='name'>add_index</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add an index on the given columns. See <a href="CreateTableGenerator.html#method-i-index"><code>CreateTableGenerator#index</code></a> for available options.</p>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># CREATE INDEX table_artist_id_index ON table (artist_id)</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_index-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_index-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">534</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">535</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:add_index</span>, <span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">536</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">537</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_primary_key'>
<a name='method-i-add_primary_key'></a>
<div class='synopsis'>
<span class='name'>add_primary_key</span><span class='arguments'>(name, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a primary key.  See <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a> for the available options.  Like <a href="AlterTableGenerator.html#method-i-add_foreign_key"><code>add_foreign_key</code></a>, if you specify the column name as an array, it just creates a constraint:</p>

<pre class="ruby"><span class="ruby-identifier">add_primary_key</span>(<span class="ruby-value">:id</span>) <span class="ruby-comment"># ADD COLUMN id serial PRIMARY KEY</span>
<span class="ruby-identifier">add_primary_key</span>([<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:name</span>]) <span class="ruby-comment"># ADD PRIMARY KEY (artist_id, name)</span>
</pre>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:include </td><td>
<p>Include additional columns in the underlying index, to allow for index-only scans in more cases (PostgreSQL 11+).</p>
</td></tr><tr><td class='label'>:using_index </td><td>
<p>Use the USING INDEX clause to specify an existing unique index</p>
</td></tr><tr><td class='label'>:without_overlaps </td><td>
<p>Use WITHOUT OVERLAPS clause to specify an exclusion constraint on the final column (PostgreSQL 18+, composite primary keys only).</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_primary_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_primary_key-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">553</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_primary_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">554</span>   <span class="ruby-keyword">return</span> <span class="ruby-identifier">add_composite_primary_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">555</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">serial_primary_key_options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">556</span>   <span class="ruby-identifier">add_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:type</span>), <span class="ruby-identifier">opts</span>)
<span class="line-num">557</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_spatial_index'>
<a name='method-i-add_spatial_index'></a>
<div class='synopsis'>
<span class='name'>add_spatial_index</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a spatial index on the given columns. See <a href="CreateTableGenerator.html#method-i-index"><code>CreateTableGenerator#index</code></a> for available options.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_spatial_index-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_spatial_index-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">561</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_spatial_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">562</span>   <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">columns</span>, {<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:spatial</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">563</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_unique_constraint'>
<a name='method-i-add_unique_constraint'></a>
<div class='synopsis'>
<span class='name'>add_unique_constraint</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a unique constraint to the given column(s)</p>

<pre class="ruby"><span class="ruby-identifier">add_unique_constraint</span>(<span class="ruby-value">:name</span>) <span class="ruby-comment"># ADD UNIQUE (name)</span>
<span class="ruby-identifier">add_unique_constraint</span>(<span class="ruby-value">:name</span>, <span class="ruby-value">name:</span> <span class="ruby-value">:unique_name</span>) <span class="ruby-comment"># ADD CONSTRAINT unique_name UNIQUE (name)</span>
</pre>

<p>Supports the same :deferrable option as <a href="CreateTableGenerator.html#method-i-column"><code>CreateTableGenerator#column</code></a>.</p>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:include </td><td>
<p>Include additional columns in the underlying index, to allow for index-only scans in more cases (PostgreSQL 11+).</p>
</td></tr><tr><td class='label'>:nulls_not_distinct </td><td>
<p>Use NULLS NOT DISTINCT to setup a constraint where NULL entries are considered distinct (PostgreSQL 15+)</p>
</td></tr><tr><td class='label'>:using_index </td><td>
<p>Use the USING INDEX clause to specify an existing unique index</p>
</td></tr><tr><td class='label'>:without_overlaps </td><td>
<p>Use WITHOUT OVERLAPS clause to specify an exclusion constraint on the final column (PostgreSQL 18+, composite unique constraints only).</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_unique_constraint-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_unique_constraint-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">492</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_unique_constraint</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">493</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:add_constraint</span>, <span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:unique</span>, <span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">494</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">495</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-drop_column'>
<a name='method-i-drop_column'></a>
<div class='synopsis'>
<span class='name'>drop_column</span><span class='arguments'>(name, opts=OPTS)</span>

</div>
<div class='description'>

<p>Remove a column from the table.</p>

<pre class="ruby"><span class="ruby-identifier">drop_column</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># DROP COLUMN artist_id</span>
<span class="ruby-identifier">drop_column</span>(<span class="ruby-value">:artist_id</span>, <span class="ruby-value">cascade:</span> <span class="ruby-keyword">true</span>) <span class="ruby-comment"># DROP COLUMN artist_id CASCADE</span>
</pre>

<p>Options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:cascade </td><td>
<p>CASCADE the operation, dropping other objects that depend on the dropped column.</p>
</td></tr></tbody></table>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:if_exists </td><td>
<p>Use IF EXISTS, so no error is raised if the column does not exist.</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-drop_column-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-drop_column-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">578</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">579</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:drop_column</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">580</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">581</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-drop_constraint'>
<a name='method-i-drop_constraint'></a>
<div class='synopsis'>
<span class='name'>drop_constraint</span><span class='arguments'>(name, opts=OPTS)</span>

</div>
<div class='description'>

<p>Remove a constraint from the table:</p>

<pre class="ruby"><span class="ruby-identifier">drop_constraint</span>(<span class="ruby-value">:unique_name</span>) <span class="ruby-comment"># DROP CONSTRAINT unique_name</span>
<span class="ruby-identifier">drop_constraint</span>(<span class="ruby-value">:unique_name</span>, <span class="ruby-value">cascade:</span> <span class="ruby-keyword">true</span>) <span class="ruby-comment"># DROP CONSTRAINT unique_name CASCADE</span>
</pre>

<p>MySQL/SQLite specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:type </td><td>
<p>Set the type of constraint to drop, either :primary_key, :foreign_key, or :unique.</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-drop_constraint-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-drop_constraint-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">592</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_constraint</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">593</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:drop_constraint</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">594</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">595</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-drop_foreign_key'>
<a name='method-i-drop_foreign_key'></a>
<div class='synopsis'>
<span class='name'>drop_foreign_key</span><span class='arguments'>(name, opts=OPTS)</span>

</div>
<div class='description'>

<p>Remove a foreign key and the associated column from the table. General options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:name </td><td>
<p>The name of the constraint to drop.  If not given, uses the same name that would be used by <a href="AlterTableGenerator.html#method-i-add_foreign_key"><code>add_foreign_key</code></a> with the same columns.</p>
</td></tr></tbody></table>

<p>NOTE: If you want to drop only the foreign key constraint but keep the column, use the composite key syntax even if it is only one column.</p>

<pre class="ruby"><span class="ruby-identifier">drop_foreign_key</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># DROP CONSTRAINT table_artist_id_fkey, DROP COLUMN artist_id</span>
<span class="ruby-identifier">drop_foreign_key</span>([<span class="ruby-value">:name</span>]) <span class="ruby-comment"># DROP CONSTRAINT table_name_fkey</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-drop_foreign_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-drop_foreign_key-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">607</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">608</span>   <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:foreign_key_constraint_name</span>]
<span class="line-num">609</span>     <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">opts</span>]
<span class="line-num">610</span>     <span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:foreign_key_constraint_name</span>]
<span class="line-num">611</span>   <span class="ruby-keyword">end</span>
<span class="line-num">612</span>   <span class="ruby-identifier">drop_composite_foreign_key</span>(<span class="ruby-constant">Array</span>(<span class="ruby-identifier">name</span>), <span class="ruby-identifier">opts</span>)
<span class="line-num">613</span>   <span class="ruby-identifier">drop_column</span>(<span class="ruby-identifier">name</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">614</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-drop_index'>
<a name='method-i-drop_index'></a>
<div class='synopsis'>
<span class='name'>drop_index</span><span class='arguments'>(columns, options=OPTS)</span>

</div>
<div class='description'>

<p>Remove an index from the table. General options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:name </td><td>
<p>The name of the index to drop.  If not given, uses the same name that would be used by <a href="AlterTableGenerator.html#method-i-add_index"><code>add_index</code></a> with the same columns.</p>
</td></tr></tbody></table>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:cascade </td><td>
<p>Cascade the index drop to dependent objects.</p>
</td></tr><tr><td class='label'>:concurrently </td><td>
<p>Drop the index using CONCURRENTLY, which doesn’t block operations on the table.  Supported in PostgreSQL 9.2+.</p>
</td></tr><tr><td class='label'>:if_exists </td><td>
<p>Only drop the index if it already exists.</p>
</td></tr></tbody></table>

<pre class="ruby"><span class="ruby-identifier">drop_index</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># DROP INDEX table_artist_id_index</span>
<span class="ruby-identifier">drop_index</span>([<span class="ruby-value">:a</span>, <span class="ruby-value">:b</span>]) <span class="ruby-comment"># DROP INDEX table_a_b_index</span>
<span class="ruby-identifier">drop_index</span>([<span class="ruby-value">:a</span>, <span class="ruby-value">:b</span>], <span class="ruby-value">name:</span> <span class="ruby-value">:foo</span>) <span class="ruby-comment"># DROP INDEX foo</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-drop_index-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-drop_index-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">631</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">drop_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">options</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">632</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:drop_index</span>, <span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">options</span>)
<span class="line-num">633</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">634</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-rename_column'>
<a name='method-i-rename_column'></a>
<div class='synopsis'>
<span class='name'>rename_column</span><span class='arguments'>(name, new_name, opts = OPTS)</span>

</div>
<div class='description'>

<p>Rename one of the table’s columns.</p>

<pre class="ruby"><span class="ruby-identifier">rename_column</span>(<span class="ruby-value">:name</span>, <span class="ruby-value">:artist_name</span>) <span class="ruby-comment"># RENAME COLUMN name TO artist_name</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-rename_column-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-rename_column-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">639</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">rename_column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">new_name</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">640</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:rename_column</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:new_name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">new_name</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">641</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">642</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_column_allow_null'>
<a name='method-i-set_column_allow_null'></a>
<div class='synopsis'>
<span class='name'>set_column_allow_null</span><span class='arguments'>(name, allow_null=true)</span>

</div>
<div class='description'>

<p>Set a given column as allowing NULL values.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_allow_null</span>(<span class="ruby-value">:artist_name</span>) <span class="ruby-comment"># ALTER COLUMN artist_name DROP NOT NULL</span>
</pre>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the default and type for the column.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_column_allow_null-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_column_allow_null-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">680</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_allow_null</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">allow_null</span>=<span class="ruby-keyword">true</span>)
<span class="line-num">681</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:set_column_null</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:null</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">allow_null</span>}
<span class="line-num">682</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">683</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_column_default'>
<a name='method-i-set_column_default'></a>
<div class='synopsis'>
<span class='name'>set_column_default</span><span class='arguments'>(name, default)</span>

</div>
<div class='description'>

<p>Modify the default value for one of the table’s column.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_default</span>(<span class="ruby-value">:artist_name</span>, <span class="ruby-string">&#39;a&#39;</span>) <span class="ruby-comment"># ALTER COLUMN artist_name SET DEFAULT &#39;a&#39;</span>
</pre>

<p>To remove an existing default value, use <code>nil</code> as the value:</p>

<pre class="ruby"><span class="ruby-identifier">set_column_default</span>(<span class="ruby-value">:artist_name</span>, <span class="ruby-keyword">nil</span>) <span class="ruby-comment"># ALTER COLUMN artist_name SET DEFAULT NULL</span>
</pre>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the type and NULL/NOT NULL setting for the column.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_column_default-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_column_default-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">654</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_default</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">default</span>)
<span class="line-num">655</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:set_column_default</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">default</span>}
<span class="line-num">656</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">657</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_column_not_null'>
<a name='method-i-set_column_not_null'></a>
<div class='synopsis'>
<span class='name'>set_column_not_null</span><span class='arguments'>(name)</span>

</div>
<div class='description'>

<p>Set a given column as not allowing NULL values.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_not_null</span>(<span class="ruby-value">:artist_name</span>) <span class="ruby-comment"># ALTER COLUMN artist_name SET NOT NULL</span>
</pre>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the default and type for the column.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_column_not_null-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_column_not_null-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">691</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_not_null</span>(<span class="ruby-identifier">name</span>)
<span class="line-num">692</span>   <span class="ruby-identifier">set_column_allow_null</span>(<span class="ruby-identifier">name</span>, <span class="ruby-keyword">false</span>)
<span class="line-num">693</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_column_type'>
<a name='method-i-set_column_type'></a>
<div class='synopsis'>
<span class='name'>set_column_type</span><span class='arguments'>(name, type, opts=OPTS)</span>

</div>
<div class='description'>

<p>Modify the type of one of the table’s column.</p>

<pre class="ruby"><span class="ruby-identifier">set_column_type</span>(<span class="ruby-value">:artist_name</span>, <span class="ruby-string">&#39;char(10)&#39;</span>) <span class="ruby-comment"># ALTER COLUMN artist_name TYPE char(10)</span>
</pre>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:using </td><td>
<p>Add a USING clause that specifies how to convert existing values to new values.</p>
</td></tr></tbody></table>

<p>On MySQL, make sure to use a symbol for the name of the column, as otherwise you can lose the default and NULL/NOT NULL setting for the column.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_column_type-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_column_type-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">669</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_column_type</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">670</span>   <span class="ruby-ivar">@operations</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:op</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:set_column_type</span>, <span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">type</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">671</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">672</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>

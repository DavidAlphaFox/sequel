<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Sequel::Schema::CreateTableGenerator</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>class</span>
Sequel::Schema::CreateTableGenerator
</h1>
<ol class='paths'>
<li>
<a href="../../../files/lib/sequel/database/schema_generator_rb.html">lib/sequel/database/schema_generator.rb</a>
</li>
</ol>
<div class='parent'>
Superclass:
<strong>Object</strong>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p><a href="CreateTableGenerator.html"><code>Schema::CreateTableGenerator</code></a> is an internal class that the user is not expected to instantiate directly.  Instances are created by <a href="../Database.html#method-i-create_table"><code>Database#create_table</code></a>. It is used to specify table creation parameters.  It takes a <a href="../Database.html"><code>Database</code></a> object and a block of column/index/constraint specifications, and gives the <a href="../Database.html"><code>Database</code></a> a table description, which the database uses to create a table.</p>

<p><a href="CreateTableGenerator.html"><code>Schema::CreateTableGenerator</code></a> has some methods but also includes <a href="CreateTableGenerator.html#method-i-method_missing"><code>method_missing</code></a>, allowing users to specify column type as a method instead of using the column method, which makes for a nicer DSL.</p>

<p>For more information on Sequel’s support for schema modification, see the <a href="../../../files/doc/schema_modification_rdoc.html">“Schema Modification” guide</a>.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-add_type_method">add_type_method</a></li>
<li><a href="#method-c-new">new</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-Bignum">Bignum</a></li>
<li><a href="#method-i-Fixnum">Fixnum</a></li>
<li><a href="#method-i-check">check</a></li>
<li><a href="#method-i-column">column</a></li>
<li><a href="#attribute-i-columns">columns</a></li>
<li><a href="#method-i-constraint">constraint</a></li>
<li><a href="#attribute-i-constraints">constraints</a></li>
<li><a href="#method-i-foreign_key">foreign_key</a></li>
<li><a href="#method-i-full_text_index">full_text_index</a></li>
<li><a href="#method-i-has_column-3F">has_column?</a></li>
<li><a href="#method-i-index">index</a></li>
<li><a href="#attribute-i-indexes">indexes</a></li>
<li><a href="#method-i-method_missing">method_missing</a></li>
<li><a href="#method-i-primary_key">primary_key</a></li>
<li><a href="#method-i-primary_key_name">primary_key_name</a></li>
<li><a href="#method-i-respond_to_missing-3F">respond_to_missing?</a></li>
<li><a href="#method-i-spatial_index">spatial_index</a></li>
<li><a href="#method-i-unique">unique</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='constants-list'>
<h2>Constants</h2>
<div class='name-list'>
<table summary='Constants'>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>GENERIC_TYPES</td>
<td>=</td>
<td class='context-item-value'>%w'String Integer Float Numeric BigDecimal Date DateTime Time File TrueClass FalseClass'.freeze</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>Classes specifying generic types that <a href="../../Sequel.html"><code>Sequel</code></a> will convert to database-specific types.</p>
</td>
</tr>
</table>
</div>
</div>
<div id='attribute-list'>
<h2 class='section-bar'>Attributes</h2>
<div class='name-list'>
<table>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-columns'>columns</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>Column hashes created by this generator</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-constraints'>constraints</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>Constraint hashes created by this generator</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-indexes'>indexes</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>Index hashes created by this generator</p>
</td>
</tr>
</table>
</div>
</div>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-add_type_method'>
<a name='method-c-add_type_method'></a>
<div class='synopsis'>
<span class='name'>add_type_method</span><span class='arguments'>(*types)</span>

</div>
<div class='description'>

<p>Add a method for each of the given types that creates a column with that type as a constant.  Types given should either already be constants/classes or a capitalized string/symbol with the same name as a constant/class.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-add_type_method-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-add_type_method-source'>   <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">59</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">add_type_method</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">types</span>)
<span class="line-num">60</span>   <span class="ruby-identifier">types</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">type</span><span class="ruby-operator">|</span>
<span class="line-num">61</span>     <span class="ruby-keyword">case</span> <span class="ruby-identifier">type</span>
<span class="line-num">62</span>     <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>, <span class="ruby-constant">String</span>
<span class="line-num">63</span>       <span class="ruby-identifier">method</span> = <span class="ruby-identifier">type</span>
<span class="line-num">64</span>       <span class="ruby-identifier">type</span> = <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">type</span>)
<span class="line-num">65</span>     <span class="ruby-keyword">else</span>
<span class="line-num">66</span>       <span class="ruby-identifier">method</span> = <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_s</span>
<span class="line-num">67</span>     <span class="ruby-keyword">end</span>
<span class="line-num">68</span> 
<span class="line-num">69</span>     <span class="ruby-identifier">define_method</span>(<span class="ruby-identifier">method</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span><span class="ruby-operator">|</span> <span class="ruby-identifier">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>)}
<span class="line-num">70</span>   <span class="ruby-keyword">end</span>
<span class="line-num">71</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">72</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span><span class='arguments'>(db, &block)</span>

</div>
<div class='description'>

<p>Set the database in which to create the table, and evaluate the block in the context of this object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'>   <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">34</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">db</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">35</span>   <span class="ruby-ivar">@db</span> = <span class="ruby-identifier">db</span>
<span class="line-num">36</span>   <span class="ruby-ivar">@columns</span> = []
<span class="line-num">37</span>   <span class="ruby-ivar">@indexes</span> = []
<span class="line-num">38</span>   <span class="ruby-ivar">@constraints</span> = []
<span class="line-num">39</span>   <span class="ruby-ivar">@primary_key</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">40</span>   <span class="ruby-identifier">instance_exec</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
<span class="line-num">41</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-Bignum'>
<a name='method-i-Bignum'></a>
<div class='synopsis'>
<span class='name'>Bignum</span><span class='arguments'>(name, opts=OPTS)</span>

</div>
<div class='description'>

<p>Use custom <a href="CreateTableGenerator.html#method-i-Bignum"><code>Bignum</code></a> method to use :Bignum instead of <a href="CreateTableGenerator.html#method-i-Bignum"><code>Bignum</code></a> class, to work correctly in cases where <a href="CreateTableGenerator.html#method-i-Bignum"><code>Bignum</code></a> is the same as Integer.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-Bignum-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-Bignum-source'>   <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">45</span> <span class="ruby-keyword">def</span> <span class="ruby-constant">Bignum</span>(<span class="ruby-identifier ruby-title">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">46</span>   <span class="ruby-identifier">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-value">:Bignum</span>, <span class="ruby-identifier">opts</span>)
<span class="line-num">47</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-Fixnum'>
<a name='method-i-Fixnum'></a>
<div class='synopsis'>
<span class='name'>Fixnum</span><span class='arguments'>(name, opts=OPTS)</span>

</div>
<div class='description'>

<p>Use custom <a href="CreateTableGenerator.html#method-i-Fixnum"><code>Fixnum</code></a> method to use Integer instead of <a href="CreateTableGenerator.html#method-i-Fixnum"><code>Fixnum</code></a> class, to avoid  warnings on ruby 2.4+.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-Fixnum-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-Fixnum-source'>   <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">51</span> <span class="ruby-keyword">def</span> <span class="ruby-constant">Fixnum</span>(<span class="ruby-identifier ruby-title">name</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num">52</span>   <span class="ruby-identifier">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">Integer</span>, <span class="ruby-identifier">opts</span>)
<span class="line-num">53</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check'>
<a name='method-i-check'></a>
<div class='synopsis'>
<span class='name'>check</span><span class='arguments'>(*args, &block)</span>

</div>
<div class='description'>

<p>Add an unnamed constraint, specified by the given block or args:</p>

<pre class="ruby"><span class="ruby-identifier">check</span>(<span class="ruby-value">num:</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>) <span class="ruby-comment"># CHECK num &gt;= 1 AND num &lt;= 5</span>
<span class="ruby-identifier">check</span>{<span class="ruby-identifier">num</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">5</span>}   <span class="ruby-comment"># CHECK num &gt; 5</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check-source'>   <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">79</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">80</span>   <span class="ruby-identifier">constraint</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">81</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-column'>
<a name='method-i-column'></a>
<div class='synopsis'>
<span class='name'>column</span><span class='arguments'>(name, type, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a column with the given name, type, and opts:</p>

<pre class="ruby"><span class="ruby-identifier">column</span> <span class="ruby-value">:num</span>, <span class="ruby-value">:integer</span>
<span class="ruby-comment"># num INTEGER</span>

<span class="ruby-identifier">column</span> <span class="ruby-value">:name</span>, <span class="ruby-constant">String</span>, <span class="ruby-value">null:</span> <span class="ruby-keyword">false</span>, <span class="ruby-value">default:</span> <span class="ruby-string">&#39;a&#39;</span>
<span class="ruby-comment"># name varchar(255) NOT NULL DEFAULT &#39;a&#39;</span>

<span class="ruby-identifier">inet</span> <span class="ruby-value">:ip</span>
<span class="ruby-comment"># ip inet</span>
</pre>

<p>You can also create columns via method missing, so the following are equivalent:</p>

<pre class="ruby"><span class="ruby-identifier">column</span> <span class="ruby-value">:number</span>, <span class="ruby-value">:integer</span>
<span class="ruby-identifier">integer</span> <span class="ruby-value">:number</span>
</pre>

<p>The following options are supported:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:collate </td><td>
<p>The collation to use for the column.  For backwards compatibility, only symbols and string values are supported, and they are used verbatim. However, on PostgreSQL, symbols are literalized as regular identifiers, since unquoted collations are unlikely to be valid.</p>
</td></tr><tr><td class='label'>:default </td><td>
<p>The default value for the column.</p>
</td></tr><tr><td class='label'>:deferrable </td><td>
<p>For foreign key columns, this ensures referential integrity will work even if referencing table uses a foreign key value that does not yet exist on referenced table (but will exist before the transaction commits). Basically it adds DEFERRABLE INITIALLY DEFERRED on key creation. If you use :immediate as the value, uses DEFERRABLE INITIALLY IMMEDIATE.</p>
</td></tr><tr><td class='label'>:generated_always_as </td><td>
<p>Specify a GENERATED ALWAYS AS column expression, if generated columns are supported (PostgreSQL 12+, MariaDB <a href="../../../files/doc/release_notes/5_2_0_txt.html">5.2.0</a>+, and MySQL 5.7.6+).</p>
</td></tr><tr><td class='label'>:index </td><td>
<p>Create an index on this column.  If given a hash, use the hash as the options for the index.</p>
</td></tr><tr><td class='label'>:key </td><td>
<p>For foreign key columns, the column in the associated table that this column references.  Unnecessary if this column references the primary key of the associated table, except if you are using MySQL.</p>
</td></tr><tr><td class='label'>:null </td><td>
<p>Mark the column as allowing NULL values (if true), or not allowing NULL values (if false).  The default is to allow NULL values.</p>
</td></tr><tr><td class='label'>:on_delete </td><td>
<p>Specify the behavior of this column when being deleted (:restrict, :cascade, :set_null, :set_default, :no_action).</p>
</td></tr><tr><td class='label'>:on_update </td><td>
<p>Specify the behavior of this column when being updated (:restrict, :cascade, :set_null, :set_default, :no_action).</p>
</td></tr><tr><td class='label'>:primary_key </td><td>
<p>Make the column as a single primary key column.  This should not be used if you want a single autoincrementing primary key column (use the <a href="CreateTableGenerator.html#method-i-primary_key"><code>primary_key</code></a> method in that case).</p>
</td></tr><tr><td class='label'>:primary_key_constraint_name </td><td>
<p>The name to give the primary key constraint</p>
</td></tr><tr><td class='label'>:primary_key_deferrable </td><td>
<p>Similar to :deferrable, but for the primary key constraint if :primary_key is used.</p>
</td></tr><tr><td class='label'>:type </td><td>
<p>Overrides the type given as the argument.  Generally not used by column itself, but can be passed as an option to other methods that call column.</p>
</td></tr><tr><td class='label'>:unique </td><td>
<p>Mark the column as unique, generally has the same effect as creating a unique index on the column.</p>
</td></tr><tr><td class='label'>:unique_constraint_name </td><td>
<p>The name to give the unique key constraint</p>
</td></tr><tr><td class='label'>:unique_deferrable </td><td>
<p>Similar to :deferrable, but for the unique constraint if :unique is used.</p>
</td></tr></tbody></table>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:identity </td><td>
<p>Create an identity column.</p>
</td></tr></tbody></table>

<p>MySQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:generated_type </td><td>
<p>Set the type of column when using :generated_always_as, should be :virtual or :stored to force a type.</p>
</td></tr><tr><td class='label'>:on_update_current_timestamp </td><td>
<p>Use ON UPDATE CURRENT TIMESTAMP when defining the column, which will update the column value to CURRENT_TIMESTAMP on every UPDATE.</p>
</td></tr></tbody></table>

<p>Microsoft <a href="../SQL.html"><code>SQL</code></a> Server specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:clustered </td><td>
<p>When using :primary_key or :unique, marks the primary key or unique constraint as CLUSTERED (if true), or NONCLUSTERED (if false).</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-column-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-column-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">157</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">158</span>   <span class="ruby-identifier">columns</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>, <span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">type</span>}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">159</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">index_opts</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:index</span>]
<span class="line-num">160</span>     <span class="ruby-identifier">index</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">index_opts</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">index_opts</span> <span class="ruby-operator">:</span> <span class="ruby-constant">OPTS</span>)
<span class="line-num">161</span>   <span class="ruby-keyword">end</span>
<span class="line-num">162</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">163</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-constraint'>
<a name='method-i-constraint'></a>
<div class='synopsis'>
<span class='name'>constraint</span><span class='arguments'>(name, *args, &block)</span>

</div>
<div class='description'>

<p>Adds a named CHECK constraint (or unnamed if name is nil), with the given block or args. To provide options for the constraint, pass a hash as the first argument.</p>

<pre class="ruby"><span class="ruby-identifier">constraint</span>(<span class="ruby-value">:blah</span>, <span class="ruby-value">num:</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
<span class="ruby-comment"># CONSTRAINT blah CHECK num &gt;= 1 AND num &lt;= 5</span>
<span class="ruby-identifier">constraint</span>({<span class="ruby-value">name:</span> <span class="ruby-value">:blah</span>, <span class="ruby-value">deferrable:</span> <span class="ruby-keyword">true</span>}, <span class="ruby-value">num:</span> <span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">5</span>)
<span class="ruby-comment"># CONSTRAINT blah CHECK num &gt;= 1 AND num &lt;= 5 DEFERRABLE INITIALLY DEFERRED</span>
</pre>

<p>If the first argument is a hash, the following options are supported:</p>

<p>Options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:name </td><td>
<p>The name of the CHECK constraint</p>
</td></tr><tr><td class='label'>:deferrable </td><td>
<p>Whether the CHECK constraint should be marked DEFERRABLE.</p>
</td></tr></tbody></table>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:not_valid </td><td>
<p>Whether the CHECK constraint should be marked NOT VALID.</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-constraint-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-constraint-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">182</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">constraint</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">183</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> {<span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">name</span>}
<span class="line-num">184</span>   <span class="ruby-identifier">constraints</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:type</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:check</span>, <span class="ruby-value">:check</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">block</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">args</span>)
<span class="line-num">185</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">186</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-foreign_key'>
<a name='method-i-foreign_key'></a>
<div class='synopsis'>
<span class='name'>foreign_key</span><span class='arguments'>(name, table=nil, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a foreign key in the table that references another table. See <a href="CreateTableGenerator.html#method-i-column"><code>column</code></a> for available options.</p>

<pre class="ruby"><span class="ruby-identifier">foreign_key</span>(<span class="ruby-value">:artist_id</span>) <span class="ruby-comment"># artist_id INTEGER</span>
<span class="ruby-identifier">foreign_key</span>(<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:artists</span>) <span class="ruby-comment"># artist_id INTEGER REFERENCES artists</span>
<span class="ruby-identifier">foreign_key</span>(<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:artists</span>, <span class="ruby-value">key:</span> <span class="ruby-value">:id</span>) <span class="ruby-comment"># artist_id INTEGER REFERENCES artists(id)</span>
<span class="ruby-identifier">foreign_key</span>(<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:artists</span>, <span class="ruby-value">type:</span> <span class="ruby-constant">String</span>) <span class="ruby-comment"># artist_id varchar(255) REFERENCES artists(id)</span>
</pre>

<p>Additional Options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:foreign_key_constraint_name </td><td>
<p>The name to give the foreign key constraint</p>
</td></tr></tbody></table>

<p>If you want a foreign key constraint without adding a column (usually because it is a composite foreign key), you can provide an array of columns as the first argument, and you can provide the :name option to name the constraint:</p>

<pre class="ruby"><span class="ruby-identifier">foreign_key</span>([<span class="ruby-value">:artist_name</span>, <span class="ruby-value">:artist_location</span>], <span class="ruby-value">:artists</span>, <span class="ruby-value">name:</span> <span class="ruby-value">:artist_fk</span>)
<span class="ruby-comment"># ADD CONSTRAINT artist_fk FOREIGN KEY (artist_name, artist_location) REFERENCES artists</span>
</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-foreign_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-foreign_key-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">206</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">table</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">207</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">table</span>
<span class="line-num">208</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
<span class="line-num">209</span>     <span class="ruby-identifier">table</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">210</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">NilClass</span>
<span class="line-num">211</span>     <span class="ruby-identifier">opts</span>
<span class="line-num">212</span>   <span class="ruby-keyword">else</span>
<span class="line-num">213</span>     <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:table</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">table</span>)
<span class="line-num">214</span>   <span class="ruby-keyword">end</span>
<span class="line-num">215</span>   <span class="ruby-keyword">return</span> <span class="ruby-identifier">composite_foreign_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">216</span>   <span class="ruby-identifier">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-constant">Integer</span>, <span class="ruby-identifier">opts</span>)
<span class="line-num">217</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-full_text_index'>
<a name='method-i-full_text_index'></a>
<div class='synopsis'>
<span class='name'>full_text_index</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a full text index on the given columns. See <a href="CreateTableGenerator.html#method-i-index"><code>index</code></a> for additional options.</p>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:index_type </td><td>
<p>Can be set to :gist to use a GIST index instead of the default GIN index.</p>
</td></tr><tr><td class='label'>:language </td><td>
<p>Set a language to use for the index (default: simple).</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-full_text_index-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-full_text_index-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">226</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">full_text_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">227</span>   <span class="ruby-identifier">index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:full_text</span>))
<span class="line-num">228</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-has_column-3F'>
<a name='method-i-has_column-3F'></a>
<div class='synopsis'>
<span class='name'>has_column?</span><span class='arguments'>(name)</span>

</div>
<div class='description'>

<p>True if the generator includes the creation of a column with the given name.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-has_column-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-has_column-3F-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">231</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">has_column?</span>(<span class="ruby-identifier">name</span>)
<span class="line-num">232</span>   <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>[<span class="ruby-value">:name</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">name</span>}
<span class="line-num">233</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-index'>
<a name='method-i-index'></a>
<div class='synopsis'>
<span class='name'>index</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add an index on the given column(s) with the given options. Examples:</p>

<pre class="ruby"><span class="ruby-identifier">index</span> <span class="ruby-value">:name</span>
<span class="ruby-comment"># CREATE INDEX table_name_index ON table (name)</span>

<span class="ruby-identifier">index</span> [<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:name</span>]
<span class="ruby-comment"># CREATE INDEX table_artist_id_name_index ON table (artist_id, name)</span>

<span class="ruby-identifier">index</span> [<span class="ruby-value">:artist_id</span>, <span class="ruby-value">:name</span>], <span class="ruby-value">name:</span> <span class="ruby-value">:foo</span>
<span class="ruby-comment"># CREATE INDEX foo ON table (artist_id, name)</span>
</pre>

<p>General options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:include </td><td>
<p>Include additional column values in the index, without actually indexing on those values (only supported by some databases).</p>
</td></tr><tr><td class='label'>:name </td><td>
<p>The name to use for the index. If not given, a default name based on the table and columns is used.</p>
</td></tr><tr><td class='label'>:type </td><td>
<p>The type of index to use (only supported by some databases, :full_text and :spatial values are handled specially).</p>
</td></tr><tr><td class='label'>:unique </td><td>
<p>Make the index unique, so duplicate values are not allowed.</p>
</td></tr><tr><td class='label'>:where </td><td>
<p>A filter expression, used to create a partial index (only supported by some databases).</p>
</td></tr></tbody></table>

<p>PostgreSQL specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:concurrently </td><td>
<p>Create the index concurrently, so it doesn’t block operations on the table while the index is being built.</p>
</td></tr><tr><td class='label'>:if_not_exists </td><td>
<p>Only create the index if an index of the same name doesn’t already exist.</p>
</td></tr><tr><td class='label'>:opclass </td><td>
<p>Set an opclass to use for all columns (per-column opclasses require custom <a href="../SQL.html"><code>SQL</code></a>).</p>
</td></tr><tr><td class='label'>:tablespace </td><td>
<p>Specify tablespace for index.</p>
</td></tr></tbody></table>

<p>Microsoft <a href="../SQL.html"><code>SQL</code></a> Server specific options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:key_index </td><td>
<p>Sets the KEY INDEX to the given value.</p>
</td></tr></tbody></table>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-index-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-index-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">272</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">273</span>   <span class="ruby-identifier">indexes</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">274</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">275</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-method_missing'>
<a name='method-i-method_missing'></a>
<div class='synopsis'>
<span class='name'>method_missing</span><span class='arguments'>(type, name = nil, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a column with the given type, name, and opts.  See <a href="CreateTableGenerator.html#method-i-column"><code>column</code></a> for available options.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-method_missing-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-method_missing-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">279</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">method_missing</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">name</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">280</span>   <span class="ruby-identifier">name</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">column</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">super</span>
<span class="line-num">281</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-primary_key'>
<a name='method-i-primary_key'></a>
<div class='synopsis'>
<span class='name'>primary_key</span><span class='arguments'>(name, *args)</span>

</div>
<div class='description'>

<p>Adds an autoincrementing primary key column or a primary key constraint. To just create a constraint, the first argument should be an array of column symbols specifying the primary key columns. To create an autoincrementing primary key column, a single symbol can be used. In both cases, an options hash can be used as the second argument.</p>

<p>If you want to create a primary key column that is not autoincrementing, you should not use this method.  Instead, you should use the regular <code>column</code> method with a <code>primary_key: true</code> option.</p>

<p>If an array of column symbols is used, you can specify the :name option to name the constraint.</p>

<p>Options:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>:keep_order </td><td>
<p>For non-composite primary keys, respects the existing order of columns, overriding the default behavior of making the primary key the first column.</p>
</td></tr></tbody></table>

<p>Examples:</p>

<pre>primary_key(:id)
primary_key(:id, type: :Bignum, keep_order: true)
primary_key([:street_number, :house_number], name: :some constraint_name)</pre>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-primary_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-primary_key-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">310</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">primary_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
<span class="line-num">311</span>   <span class="ruby-keyword">return</span> <span class="ruby-identifier">composite_primary_key</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
<span class="line-num">312</span>   <span class="ruby-identifier">column</span> = <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">serial_primary_key_options</span>.<span class="ruby-identifier">merge</span>({<span class="ruby-value">:name</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>})
<span class="line-num">313</span>   
<span class="line-num">314</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span>
<span class="line-num">315</span>     <span class="ruby-identifier">opts</span> = {<span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">opts</span>} <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
<span class="line-num">316</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span>
<span class="line-num">317</span>       <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">type</span>)
<span class="line-num">318</span>     <span class="ruby-keyword">end</span>
<span class="line-num">319</span>     <span class="ruby-identifier">column</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">320</span>   <span class="ruby-keyword">end</span>
<span class="line-num">321</span> 
<span class="line-num">322</span>   <span class="ruby-ivar">@primary_key</span> = <span class="ruby-identifier">column</span>
<span class="line-num">323</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>[<span class="ruby-value">:keep_order</span>]
<span class="line-num">324</span>     <span class="ruby-identifier">columns</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">column</span>
<span class="line-num">325</span>   <span class="ruby-keyword">else</span>
<span class="line-num">326</span>     <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">column</span>)
<span class="line-num">327</span>   <span class="ruby-keyword">end</span>
<span class="line-num">328</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">329</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-primary_key_name'>
<a name='method-i-primary_key_name'></a>
<div class='synopsis'>
<span class='name'>primary_key_name</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The name of the primary key for this generator, if it has a primary key.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-primary_key_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-primary_key_name-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">332</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">primary_key_name</span>
<span class="line-num">333</span>   <span class="ruby-ivar">@primary_key</span>[<span class="ruby-value">:name</span>] <span class="ruby-keyword">if</span> <span class="ruby-ivar">@primary_key</span>
<span class="line-num">334</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-respond_to_missing-3F'>
<a name='method-i-respond_to_missing-3F'></a>
<div class='synopsis'>
<span class='name'>respond_to_missing?</span><span class='arguments'>(meth, include_private)</span>

</div>
<div class='description'>

<p>This object responds to all methods.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-respond_to_missing-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-respond_to_missing-3F-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">284</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">respond_to_missing?</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">include_private</span>)
<span class="line-num">285</span>   <span class="ruby-keyword">true</span>
<span class="line-num">286</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-spatial_index'>
<a name='method-i-spatial_index'></a>
<div class='synopsis'>
<span class='name'>spatial_index</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a spatial index on the given columns. See <a href="CreateTableGenerator.html#method-i-index"><code>index</code></a> for additional options.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-spatial_index-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-spatial_index-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">338</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">spatial_index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">339</span>   <span class="ruby-identifier">index</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:spatial</span>))
<span class="line-num">340</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unique'>
<a name='method-i-unique'></a>
<div class='synopsis'>
<span class='name'>unique</span><span class='arguments'>(columns, opts = OPTS)</span>

</div>
<div class='description'>

<p>Add a unique constraint on the given columns.</p>

<pre class="ruby"><span class="ruby-identifier">unique</span>(<span class="ruby-value">:name</span>) <span class="ruby-comment"># UNIQUE (name)</span>
</pre>

<p>Supports the same :deferrable option as <a href="CreateTableGenerator.html#method-i-column"><code>column</code></a>. The :name option can be used to name the constraint.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unique-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unique-source'>    <span class="ruby-comment"># File lib/sequel/database/schema_generator.rb</span>
<span class="line-num">348</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unique</span>(<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">opts</span> = <span class="ruby-constant">OPTS</span>)
<span class="line-num">349</span>   <span class="ruby-identifier">constraints</span> <span class="ruby-operator">&lt;&lt;</span> {<span class="ruby-value">:type</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:unique</span>, <span class="ruby-value">:columns</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">columns</span>)}.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">350</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">351</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
